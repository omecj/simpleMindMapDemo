{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { Circle, G, Text, Image } from '@svgdotjs/svg.js';\nimport { generateColorByContent } from '../../../utils/index';\n\n// 协同相关功能\n\n// 创建容器\nfunction createUserListNode() {\n  // 如果没有注册协作插件，那么需要创建\n  if (!this.mindMap.cooperate) return;\n  this._userListGroup = new G();\n  this.group.add(this._userListGroup);\n}\n\n// 创建文本头像\nfunction createTextAvatar(item) {\n  const {\n    avatarSize,\n    fontSize\n  } = this.mindMap.opt.cooperateStyle;\n  const g = new G();\n  const str = item.isMore ? item.name : String(item.name)[0];\n  // 圆\n  const circle = new Circle().size(avatarSize, avatarSize);\n  circle.fill({\n    color: item.color || generateColorByContent(str)\n  });\n  // 文本\n  const text = new Text().text(str).fill({\n    color: '#fff'\n  }).css({\n    'font-size': fontSize\n  }).dx(-fontSize / 2).dy((avatarSize - fontSize) / 2);\n  g.add(circle).add(text);\n  return g;\n}\n\n// 创建图片头像\nfunction createImageAvatar(item) {\n  const {\n    avatarSize\n  } = this.mindMap.opt.cooperateStyle;\n  return new Image().load(item.avatar).size(avatarSize, avatarSize);\n}\n\n// 更新渲染\nfunction updateUserListNode() {\n  if (!this._userListGroup) return;\n  const {\n    avatarSize\n  } = this.mindMap.opt.cooperateStyle;\n  this._userListGroup.clear();\n  // 根据当前节点长度计算最多能显示几个\n  const length = this.userList.length;\n  const maxShowCount = Math.floor(this.width / avatarSize);\n  const list = [];\n  if (length > maxShowCount) {\n    // 如果当前用户数量比最多能显示的多，最后需要显示一个提示信息\n    list.push(...this.userList.slice(0, maxShowCount - 1), {\n      isMore: true,\n      name: '+' + (length - maxShowCount + 1)\n    });\n  } else {\n    list.push(...this.userList);\n  }\n  list.forEach((item, index) => {\n    let node = null;\n    if (item.avatar) {\n      node = this.createImageAvatar(item);\n    } else {\n      node = this.createTextAvatar(item);\n    }\n    node.on('click', e => {\n      this.mindMap.emit('node_cooperate_avatar_click', item, this, node, e);\n    });\n    node.on('mouseenter', e => {\n      this.mindMap.emit('node_cooperate_avatar_mouseenter', item, this, node, e);\n    });\n    node.on('mouseleave', e => {\n      this.mindMap.emit('node_cooperate_avatar_mouseleave', item, this, node, e);\n    });\n    node.x(index * avatarSize).cy(-avatarSize / 2);\n    this._userListGroup.add(node);\n  });\n}\n\n// 添加用户\nfunction addUser(userInfo) {\n  if (this.userList.find(item => {\n    return item.id == userInfo.id;\n  })) return;\n  this.userList.push(userInfo);\n  this.updateUserListNode();\n}\n\n// 移除用户\nfunction removeUser(userInfo) {\n  const index = this.userList.findIndex(item => {\n    return item.id == userInfo.id;\n  });\n  if (index === -1) return;\n  this.userList.splice(index, 1);\n  this.updateUserListNode();\n}\n\n// 清空用户\nfunction emptyUser() {\n  this.userList = [];\n  this.updateUserListNode();\n}\nexport default {\n  createUserListNode,\n  updateUserListNode,\n  createTextAvatar,\n  createImageAvatar,\n  addUser,\n  removeUser,\n  emptyUser\n};","map":{"version":3,"names":["Circle","G","Text","Image","generateColorByContent","createUserListNode","mindMap","cooperate","_userListGroup","group","add","createTextAvatar","item","avatarSize","fontSize","opt","cooperateStyle","g","str","isMore","name","String","circle","size","fill","color","text","css","dx","dy","createImageAvatar","load","avatar","updateUserListNode","clear","length","userList","maxShowCount","Math","floor","width","list","push","slice","forEach","index","node","on","e","emit","x","cy","addUser","userInfo","find","id","removeUser","findIndex","splice","emptyUser"],"sources":["C:/Users/otff/Desktop/mindmap_demo/mind_demo/node_modules/simple-mind-map/src/core/render/node/nodeCooperate.js"],"sourcesContent":["import { Circle, G, Text, Image } from '@svgdotjs/svg.js'\r\nimport { generateColorByContent } from '../../../utils/index'\r\n\r\n// 协同相关功能\r\n\r\n// 创建容器\r\nfunction createUserListNode() {\r\n  // 如果没有注册协作插件，那么需要创建\r\n  if (!this.mindMap.cooperate) return\r\n  this._userListGroup = new G()\r\n  this.group.add(this._userListGroup)\r\n}\r\n\r\n// 创建文本头像\r\nfunction createTextAvatar(item) {\r\n  const { avatarSize, fontSize } = this.mindMap.opt.cooperateStyle\r\n  const g = new G()\r\n  const str = item.isMore ? item.name : String(item.name)[0]\r\n  // 圆\r\n  const circle = new Circle().size(avatarSize, avatarSize)\r\n  circle.fill({\r\n    color: item.color || generateColorByContent(str)\r\n  })\r\n  // 文本\r\n  const text = new Text()\r\n    .text(str)\r\n    .fill({\r\n      color: '#fff'\r\n    })\r\n    .css({\r\n      'font-size': fontSize\r\n    })\r\n    .dx(-fontSize / 2)\r\n    .dy((avatarSize - fontSize) / 2)\r\n  g.add(circle).add(text)\r\n  return g\r\n}\r\n\r\n// 创建图片头像\r\nfunction createImageAvatar(item) {\r\n  const { avatarSize } = this.mindMap.opt.cooperateStyle\r\n  return new Image().load(item.avatar).size(avatarSize, avatarSize)\r\n}\r\n\r\n// 更新渲染\r\nfunction updateUserListNode() {\r\n  if (!this._userListGroup) return\r\n  const { avatarSize } = this.mindMap.opt.cooperateStyle\r\n  this._userListGroup.clear()\r\n  // 根据当前节点长度计算最多能显示几个\r\n  const length = this.userList.length\r\n  const maxShowCount = Math.floor(this.width / avatarSize)\r\n  const list = []\r\n  if (length > maxShowCount) {\r\n    // 如果当前用户数量比最多能显示的多，最后需要显示一个提示信息\r\n    list.push(...this.userList.slice(0, maxShowCount - 1), {\r\n      isMore: true,\r\n      name: '+' + (length - maxShowCount + 1)\r\n    })\r\n  } else {\r\n    list.push(...this.userList)\r\n  }\r\n  list.forEach((item, index) => {\r\n    let node = null\r\n    if (item.avatar) {\r\n      node = this.createImageAvatar(item)\r\n    } else {\r\n      node = this.createTextAvatar(item)\r\n    }\r\n    node.on('click', (e) => {\r\n      this.mindMap.emit('node_cooperate_avatar_click', item, this, node, e)\r\n    })\r\n    node.on('mouseenter', (e) => {\r\n      this.mindMap.emit('node_cooperate_avatar_mouseenter', item, this, node, e)\r\n    })\r\n    node.on('mouseleave', (e) => {\r\n      this.mindMap.emit('node_cooperate_avatar_mouseleave', item, this, node, e)\r\n    })\r\n    node.x(index * avatarSize).cy(-avatarSize / 2)\r\n    this._userListGroup.add(node)\r\n  })\r\n}\r\n\r\n// 添加用户\r\nfunction addUser(userInfo) {\r\n  if (\r\n    this.userList.find(item => {\r\n      return item.id == userInfo.id\r\n    })\r\n  )\r\n    return\r\n  this.userList.push(userInfo)\r\n  this.updateUserListNode()\r\n}\r\n\r\n// 移除用户\r\nfunction removeUser(userInfo) {\r\n  const index = this.userList.findIndex(item => {\r\n    return item.id == userInfo.id\r\n  })\r\n  if (index === -1) return\r\n  this.userList.splice(index, 1)\r\n  this.updateUserListNode()\r\n}\r\n\r\n// 清空用户\r\nfunction emptyUser() {\r\n  this.userList = []\r\n  this.updateUserListNode()\r\n}\r\n\r\nexport default {\r\n  createUserListNode,\r\n  updateUserListNode,\r\n  createTextAvatar,\r\n  createImageAvatar,\r\n  addUser,\r\n  removeUser,\r\n  emptyUser\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}